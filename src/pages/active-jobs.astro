---
import Layout from '../layouts/Layout.astro';

// ---------------------------------------------------------
// 1. DATA ENTRY SECTION (Yahan Date Format: YYYY-MM-DD zaroori hai)
// ---------------------------------------------------------
const allJobs = [
  { 
    title: "UP Police Constable Recruitment 2025", 
    lastDate: "2025-02-15", // Feb 15, 2025
    category: "Police Jobs",
    url: "/job/up-police-constable-2025" 
  },
  { 
    title: "SSC GD Constable Online Form 2025", 
    lastDate: "2024-12-31", // Dec 31, 2024
    category: "SSC Jobs",
    url: "/job/ssc-gd-constable-2025" 
  },
  { 
    title: "RRB NTPC Application Form", 
    lastDate: "2025-03-20", 
    category: "Railway",
    url: "#" 
  },
  { 
    title: "Indian Army Agniveer Rally (Expired Example)", 
    lastDate: "2023-12-01", // Ye purani date hai, ye list me NAHI dikhegi
    category: "Army",
    url: "#" 
  }
];

// ---------------------------------------------------------
// 2. AUTOMATIC FILTER LOGIC (Magic Code)
// ---------------------------------------------------------
// Aaj ki date nikalte hain
const today = new Date().toISOString().split('T')[0];

// Sirf wahi jobs filter karo jinki Last Date aaj ya aane wale kal ki hai
const activeJobs = allJobs.filter(job => job.lastDate >= today);

// Jobs ko "Last Date" ke hisab se sort karte hain (Jo pehle khatam ho rhi hai wo upar)
activeJobs.sort((a, b) => new Date(a.lastDate).getTime() - new Date(b.lastDate).getTime());
---

<Layout title="Active Jobs Tracker - Live Application Forms">
  
  <div class="bg-white p-4 md:p-8 rounded-lg shadow-sm border-t-4 border-green-600">
    
    <div class="text-center mb-8">
      <h1 class="text-3xl font-extrabold text-gray-800 uppercase">Current Active Jobs</h1>
      <p class="text-gray-600 mt-2">Only showing forms with pending last dates. Hurry up and apply!</p>
    </div>

    <div class="overflow-x-auto">
      <table class="w-full border-collapse border border-gray-300">
        <thead>
          <tr class="bg-red-700 text-white text-sm md:text-base uppercase">
            <th class="p-3 text-left border border-gray-300 w-32">Last Date</th>
            <th class="p-3 text-left border border-gray-300">Post Name</th>
            <th class="p-3 text-center border border-gray-300 w-24">Action</th>
          </tr>
        </thead>
        <tbody>
          
          {activeJobs.length > 0 ? (
            activeJobs.map((job) => (
              <tr class="hover:bg-yellow-50 transition">
                <td class="p-3 border border-gray-300 font-bold text-red-600 text-sm whitespace-nowrap">
                  {job.lastDate.split('-').reverse().join('-')} {/* Converts 2025-02-15 to 15-02-2025 */}
                </td>
                <td class="p-3 border border-gray-300">
                  <div class="font-bold text-blue-900">{job.title}</div>
                  <span class="text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded mt-1 inline-block">
                    {job.category}
                  </span>
                </td>
                <td class="p-3 border border-gray-300 text-center">
                  <a href={job.url} class="bg-green-600 hover:bg-green-700 text-white text-xs font-bold py-1 px-3 rounded shadow">
                    Apply
                  </a>
                </td>
              </tr>
            ))
          ) : (
            <tr>
              <td colspan="3" class="p-6 text-center text-gray-500 font-bold">
                No active jobs found right now. Check back later!
              </td>
            </tr>
          )}

        </tbody>
      </table>
    </div>

  </div>
</Layout>
