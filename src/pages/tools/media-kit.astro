---
// File Location: src/pages/tools/media-kit.astro

import Layout from '../../layouts/Layout.astro';
---

<Layout title="Free Social Media Kit Generator - TopOnlineForm">
  
  <main class="page-container">
    <div class="header-section">
      <h1>ðŸŽ¨ Social Media Kit Generator</h1>
      <p>Create professional DPs and Banners for your social media channels instantly. <br>Tap on any text to edit it!</p>
    </div>

    <section class="tool-section">
      <div class="tool-header">
        <h2>WhatsApp & Telegram DP</h2>
        <span class="badge">Square / Circle</span>
      </div>
      
      <div class="canvas-area">
        <div id="wa-dp" class="dp-circle wa-style">
          <div class="news-badge" contenteditable="true">Daily Updates</div>
          <div class="big-text-1" contenteditable="true">SARKARI</div>
          <div class="big-text-2" contenteditable="true">NAUKRI</div>
          <div class="brand-sub">Top Online Form</div>
        </div>
      </div>

      <div class="controls">
        <button class="download-btn" onclick="downloadImage('wa-dp', 'Whatsapp_DP')">
          ðŸ“¥ Download Image
        </button>
      </div>
    </section>

    <section class="tool-section">
      <div class="tool-header">
        <h2>Official Brand Logo (X/Twitter)</h2>
        <span class="badge">Official Seal</span>
      </div>
      
      <div class="canvas-area">
        <div id="x-dp" class="dp-circle x-style">
          <div class="seal-border">
            <div class="t-wrapper">
              <div class="t-top"><div class="dot"></div><div class="dot"></div><div class="dot"></div></div>
              <div class="stem"></div>
            </div>
            <div class="dp-scan-line"></div>
            <div class="dp-brand-text">Top Online Form</div>
          </div>
        </div>
      </div>

      <div class="controls">
        <button class="download-btn" onclick="downloadImage('x-dp', 'Brand_Logo')">
          ðŸ“¥ Download Logo
        </button>
      </div>
    </section>

    <section class="tool-section">
      <div class="tool-header">
        <h2>Header Banner</h2>
        <span class="badge">1500 x 500px</span>
      </div>
      
      <div class="canvas-area scroll-x">
        <div id="x-banner" class="x-banner">
          <div class="bg-pattern"></div>
          <div class="banner-scan"></div>
          <div class="banner-left"></div>
          <div class="banner-content">
            <div class="banner-badge" contenteditable="true">Fastest Updates</div>
            <div class="banner-title" contenteditable="true">GOVT JOBS<br>& RESULTS</div>
            <div class="banner-subtitle" contenteditable="true">Admit Card â€¢ Answer Key â€¢ Schemes</div>
            <div class="banner-url">TopOnlineForm.com</div>
          </div>
        </div>
      </div>

      <div class="controls">
        <button class="download-btn" onclick="downloadImage('x-banner', 'Header_Banner')">
          ðŸ“¥ Download Banner
        </button>
      </div>
    </section>

  </main>
</Layout>

<script is:inline src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

<script is:inline>
  function downloadImage(elementId, fileName) {
    const element = document.getElementById(elementId);
    const btn = event.target;
    const originalText = btn.innerText;
    
    // Feedback to user
    btn.innerText = "Generating... â³";
    btn.style.opacity = "0.7";

    html2canvas(element, {
      scale: 3, // High Quality (3x Resolution)
      backgroundColor: null,
      useCORS: true,
      allowTaint: true,
      logging: false,
      // âœ… VITAL FIX: Reset scale and margins specifically for the screenshot
      onclone: (clonedDoc) => {
        const clonedElement = clonedDoc.getElementById(elementId);
        
        // 1. Reset Transform (fix alignment issues caused by zoom)
        clonedElement.style.transform = "scale(1)";
        
        // 2. Remove negative margins (fix layout clipping)
        clonedElement.style.margin = "0";
        
        // 3. Force Dimensions for Banner (ensure full width capture)
        if(elementId === 'x-banner') {
             clonedElement.style.width = "1000px";
             clonedElement.style.height = "333px";
        }

        // 4. Disable editing indicators (cursors/borders) in the final image
        const editables = clonedElement.querySelectorAll('[contenteditable="true"]');
        editables.forEach(el => el.setAttribute('contenteditable', 'false'));
      }
    }).then(canvas => {
      const link = document.createElement('a');
      link.download = fileName + '.png';
      link.href = canvas.toDataURL('image/png');
      link.click();
      
      // Reset button
      btn.innerText = "âœ… Downloaded!";
      setTimeout(() => {
        btn.innerText = originalText;
        btn.style.opacity = "1";
      }, 2000);
    }).catch(err => {
      console.error(err);
      alert("Error generating image. Please try on a different browser.");
      btn.innerText = originalText;
      btn.style.opacity = "1";
    });
  }
</script>

<style>
  /* --- PAGE LAYOUT --- */
  .page-container {
    max-width: 800px;
    margin: 0 auto;
    padding: 40px 20px;
    color: white;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  }

  .header-section { text-align: center; margin-bottom: 60px; }
  h1 { font-size: 2.5rem; margin-bottom: 10px; color: #facc15; }
  p { color: #aaa; font-size: 1.1rem; }

  /* --- TOOL CARD STYLES --- */
  .tool-section {
    background: #1a1a1a;
    border: 1px solid #333;
    border-radius: 16px;
    padding: 30px;
    margin-bottom: 40px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.3);
  }

  .tool-header {
    display: flex; justify-content: space-between; align-items: center;
    margin-bottom: 20px; border-bottom: 1px solid #333; padding-bottom: 15px;
  }
  .tool-header h2 { margin: 0; font-size: 1.5rem; color: white; }
  .badge { background: #333; color: #ccc; padding: 4px 12px; border-radius: 20px; font-size: 0.85rem; }

  .canvas-area {
    background-image: radial-gradient(#333 1px, transparent 1px);
    background-size: 20px 20px;
    background-color: #000;
    padding: 40px;
    border-radius: 12px;
    display: flex;
    justify-content: center;
    align-items: center;
    margin-bottom: 20px;
    overflow: hidden;
  }

  /* Scrollable area for Banner on mobile */
  .scroll-x { overflow-x: auto; justify-content: flex-start; }

  .controls { text-align: center; }
  
  .download-btn {
    background-color: #dc2626;
    color: white;
    border: none;
    padding: 14px 30px;
    font-size: 1rem;
    font-weight: bold;
    border-radius: 50px;
    cursor: pointer;
    transition: all 0.2s;
    display: inline-flex; align-items: center; gap: 8px;
  }
  .download-btn:hover { background-color: #b91c1c; transform: translateY(-2px); }
  .download-btn:active { transform: scale(0.95); }

  /* =========================================
     ðŸŽ¨ DESIGN ASSETS STYLING (The Generators)
     ========================================= */

  /* 1. WHATSAPP DP */
  .wa-style {
    width: 300px; height: 300px;
    background-color: #dc2626; border-radius: 50%;
    display: flex; flex-direction: column; justify-content: center; align-items: center;
    border: 8px solid white; position: relative;
    box-shadow: 0 10px 30px rgba(0,0,0,0.5);
    flex-shrink: 0;
  }
  .news-badge {
    background: white; color: #dc2626; padding: 5px 15px; border-radius: 50px;
    font-size: 14px; font-weight: 800; text-transform: uppercase; margin-bottom: 10px; outline: none;
  }
  .big-text-1 { font-size: 45px; font-weight: 900; color: white; line-height: 0.9; outline: none; }
  .big-text-2 { font-size: 45px; font-weight: 900; color: #facc15; line-height: 0.9; margin-bottom: 10px; outline: none; }
  .brand-sub { font-size: 12px; font-weight: 700; color: white; letter-spacing: 2px; opacity: 0.9; text-transform: uppercase; border-top: 1px solid rgba(255,255,255,0.3); padding-top: 5px; }

  /* 2. X LOGO */
  .x-style {
    width: 300px; height: 300px; background-color: #dc2626; border-radius: 50%;
    display: flex; justify-content: center; align-items: center;
    border: 8px solid white; position: relative; flex-shrink: 0;
  }
  .seal-border {
    width: 260px; height: 260px; border: 3px dashed rgba(255,255,255,0.4); border-radius: 50%;
    display: flex; flex-direction: column; justify-content: center; align-items: center;
  }
  .t-wrapper { display: flex; flex-direction: column; align-items: center; gap: 8px; margin-bottom: 15px; }
  .t-top { display: flex; gap: 8px; }
  .dot { width: 25px; height: 25px; background-color: white; border-radius: 4px; }
  .stem { width: 25px; height: 60px; background-color: white; border-radius: 4px; }
  .dp-scan-line {
    width: 140px; height: 6px; background-color: #facc15; border-radius: 10px;
    position: absolute; top: 45%; box-shadow: 0 0 20px rgba(250, 204, 21, 0.8);
  }
  .dp-brand-text { font-size: 20px; font-weight: 900; color: white; text-transform: uppercase; letter-spacing: 1px; margin-top: 5px; }

  /* 3. BANNER */
  .x-banner {
    min-width: 1000px; height: 333px; /* Fixed High Res Size */
    background: linear-gradient(135deg, #dc2626 0%, #991b1b 100%);
    display: flex; position: relative; overflow: hidden;
    /* Zoom out for preview */
    transform-origin: top left; transform: scale(0.6); 
    margin-bottom: -130px; margin-right: -400px;
  }
  
  /* Mobile Adjustment for Banner Preview */
  @media (max-width: 768px) {
    .x-banner { transform: scale(0.35); margin-bottom: -210px; margin-right: -650px; }
    .header-section h1 { font-size: 1.8rem; }
  }

  .bg-pattern {
    position: absolute; top: 0; left: 0; width: 100%; height: 100%;
    background-image: radial-gradient(rgba(255,255,255,0.1) 1px, transparent 1px); background-size: 30px 30px;
  }
  .banner-left { width: 30%; }
  .banner-content { width: 70%; display: flex; flex-direction: column; justify-content: center; padding-left: 30px; }
  .banner-badge {
    background-color: #facc15; color: #991b1b; font-weight: 800; font-size: 18px;
    padding: 5px 20px; border-radius: 6px; width: fit-content; margin-bottom: 15px; text-transform: uppercase; outline: none;
  }
  .banner-title { font-size: 65px; font-weight: 900; color: white; line-height: 0.9; text-transform: uppercase; outline: none; }
  .banner-subtitle { font-size: 22px; color: rgba(255,255,255,0.9); margin-top: 15px; font-weight: 500; outline: none;}
  .banner-url {
    margin-top: 25px; font-size: 20px; color: white; font-family: monospace;
    background: rgba(0,0,0,0.2); padding: 8px 20px; border-radius: 8px; width: fit-content; border: 2px solid rgba(255,255,255,0.3);
  }
  .banner-scan {
    position: absolute; right: -50px; top: -50px; width: 250px; height: 250px;
    border: 30px solid rgba(255,255,255,0.05); border-radius: 40px; transform: rotate(15deg);
  }

</style>
