---
// src/pages/tools/age-calculator.astro
import ToolLayout from '../../layouts/ToolLayout.astro';
import AdSlot from '../../components/AdSlot.astro';

// üåç GLOBAL METADATA (Targeting Worldwide Audience)
const title = "Free Age Calculator - Calculate Chronological Age & Date Difference";
const description = "Calculate your exact age in years, months, and days. Free online tool to find date difference for job eligibility, retirement, school admission, and astrological use.";
---

<ToolLayout 
  title={title} 
  description={description}
  toolName="Age Calculator"
>
  
  {/* ‚ö° GLOBAL FAQ SCHEMA */}
  <script type="application/ld+json" slot="head">
    {
      "@context": "https://schema.org",
      "@type": "FAQPage",
      "mainEntity": [{
        "@type": "Question",
        "name": "How to calculate my exact age?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Simply enter your Date of Birth and select the 'Age at the Date of' (usually today). Our tool will calculate your chronological age down to the exact day."
        }
      }, {
        "@type": "Question",
        "name": "Is this calculator accurate for Leap Years?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Yes, our algorithm perfectly handles leap years (February 29th) and varying month lengths (30 vs 31 days) to provide 100% precision."
        }
      }, {
        "@type": "Question",
        "name": "Can I use this for Govt Job Eligibility?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Absolutely. This tool is optimized for checking age limits for exams like UPSC, SSC, IBPS (India), as well as Civil Service exams in the USA and UK."
        }
      }]
    }
  </script>

  {/* 1. TOP AD SLOT */}
  <div class="mb-8">
    <AdSlot type="horizontal" />
  </div>

  <div class="space-y-8">
      
      {/* 2. INPUT FORM */}
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          
          {/* DOB Input */}
          <div class="bg-blue-50 p-6 rounded-2xl border border-blue-100 hover:border-blue-300 transition-colors shadow-sm">
              <label class="block text-sm font-bold text-gray-700 mb-2 uppercase tracking-wider">üìÖ Date of Birth</label>
              <input type="date" id="dobInput" class="w-full p-4 border border-gray-200 rounded-xl focus:ring-4 focus:ring-blue-100 focus:border-blue-500 outline-none text-xl font-mono bg-white cursor-pointer shadow-inner text-gray-800">
          </div>

          {/* Target Date Input */}
          <div class="bg-green-50 p-6 rounded-2xl border border-green-100 hover:border-green-300 transition-colors shadow-sm">
              <label class="block text-sm font-bold text-gray-700 mb-2 uppercase tracking-wider">üìç Age at the Date of</label>
              <input type="date" id="todayInput" class="w-full p-4 border border-gray-200 rounded-xl focus:ring-4 focus:ring-green-100 focus:border-green-500 outline-none text-xl font-mono bg-white cursor-pointer shadow-inner text-gray-800">
              <p class="text-xs text-gray-500 mt-2 font-medium text-right">*Default is Today</p>
          </div>
      </div>

      {/* 3. ACTION BUTTON */}
      <button id="calcBtn" class="w-full bg-gradient-to-r from-blue-600 to-indigo-700 hover:from-blue-700 hover:to-indigo-800 text-white font-bold py-5 px-6 rounded-xl shadow-xl transform hover:-translate-y-1 transition-all text-xl md:text-2xl flex justify-center items-center gap-3">
          Calculate Age üöÄ
      </button>

      {/* 4. RESULT AREA (Initially Hidden) */}
      <div id="resultArea" class="hidden animate-fade-in space-y-8">
          
          {/* Main Card */}
          <div class="bg-gray-900 text-white rounded-3xl p-6 md:p-10 text-center shadow-2xl relative overflow-hidden border border-gray-700">
              <div class="relative z-10">
                  <p class="text-gray-400 uppercase tracking-widest text-xs font-bold mb-6">Your Chronological Age</p>
                  
                  <div class="flex justify-center items-baseline gap-4 md:gap-8 flex-wrap">
                      <div class="text-center group">
                          <span id="resYears" class="text-6xl md:text-8xl font-black text-yellow-400 group-hover:scale-110 transition-transform block filter drop-shadow-lg">0</span>
                          <span class="text-xs md:text-sm text-gray-400 uppercase tracking-wider font-bold">Years</span>
                      </div>
                      
                      <div class="text-4xl md:text-6xl text-gray-600 font-light hidden md:block pt-4">/</div>
                      
                      <div class="text-center group">
                          <span id="resMonths" class="text-6xl md:text-8xl font-black text-blue-400 group-hover:scale-110 transition-transform block filter drop-shadow-lg">0</span>
                          <span class="text-xs md:text-sm text-gray-400 uppercase tracking-wider font-bold">Months</span>
                      </div>

                      <div class="text-4xl md:text-6xl text-gray-600 font-light hidden md:block pt-4">/</div>

                      <div class="text-center group">
                          <span id="resDays" class="text-6xl md:text-8xl font-black text-green-400 group-hover:scale-110 transition-transform block filter drop-shadow-lg">0</span>
                          <span class="text-xs md:text-sm text-gray-400 uppercase tracking-wider font-bold">Days</span>
                      </div>
                  </div>
              </div>
              
              {/* Decorative Elements */}
              <div class="absolute top-0 right-0 w-64 h-64 bg-blue-600 rounded-full blur-[100px] opacity-20 pointer-events-none"></div>
              <div class="absolute bottom-0 left-0 w-64 h-64 bg-purple-600 rounded-full blur-[100px] opacity-20 pointer-events-none"></div>
          </div>

          {/* Detailed Stats Grid */}
          <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
              <div class="bg-white p-5 rounded-2xl border border-gray-100 shadow-sm text-center hover:shadow-md transition">
                  <div class="text-3xl mb-2">üéÇ</div>
                  <p class="text-xs text-gray-500 font-bold uppercase tracking-wide">Next Birthday</p>
                  <p id="nextBdayDay" class="text-blue-700 font-bold text-lg">Monday</p>
                  <p id="nextBdayMonth" class="text-xs text-gray-400 mt-1">in 5 months</p>
              </div>
              <div class="bg-white p-5 rounded-2xl border border-gray-100 shadow-sm text-center hover:shadow-md transition">
                  <div class="text-3xl mb-2">üóìÔ∏è</div>
                  <p class="text-xs text-gray-500 font-bold uppercase tracking-wide">Total Months</p>
                  <p id="totalMonths" class="text-gray-800 font-bold text-xl md:text-2xl mt-1">0</p>
              </div>
              <div class="bg-white p-5 rounded-2xl border border-gray-100 shadow-sm text-center hover:shadow-md transition">
                  <div class="text-3xl mb-2">‚òÄÔ∏è</div>
                  <p class="text-xs text-gray-500 font-bold uppercase tracking-wide">Total Days</p>
                  <p id="totalDays" class="text-gray-800 font-bold text-xl md:text-2xl mt-1">0</p>
              </div>
              <div class="bg-white p-5 rounded-2xl border border-gray-100 shadow-sm text-center hover:shadow-md transition">
                  <div class="text-3xl mb-2">‚è∞</div>
                  <p class="text-xs text-gray-500 font-bold uppercase tracking-wide">Total Hours</p>
                  <p id="totalHours" class="text-gray-800 font-bold text-xl md:text-2xl mt-1">0</p>
              </div>
          </div>

          {/* üí∞ RESULT AD SLOT */}
          <div class="mt-8">
            <span class="text-xs text-gray-400 block text-center mb-1 uppercase tracking-wider">Sponsored</span>
            <AdSlot type="horizontal" />
          </div>

      </div>
  </div>

  {/* 5. GLOBAL SEO CONTENT */}
  <div slot="content">
      <h3 class="text-xl font-bold text-gray-800 mb-3">About this Calculator</h3>
      <p class="text-gray-600 mb-6 leading-relaxed">
          The <strong>Infinity Age Calculator</strong> is a versatile tool designed to determine the precise time duration between two dates. Whether you need to calculate your chronological age, find out the days remaining until your next birthday, or check eligibility for legal requirements, this tool provides 100% accurate results instantly.
      </p>

      <div class="grid md:grid-cols-2 gap-8 mb-8">
          <div>
            <h4 class="font-bold text-gray-800 mb-2 flex items-center gap-2">üåç Global Uses</h4>
            <ul class="space-y-2 text-sm text-gray-600">
                <li class="flex items-center gap-2">‚úÖ <strong>School Admission:</strong> Check if your child meets the age cutoff (e.g., 5 or 6 years).</li>
                <li class="flex items-center gap-2">‚úÖ <strong>Legal Milestones:</strong> Verify age for Voting (18+), Driving (16/18+), or Retirement (60/65+).</li>
                <li class="flex items-center gap-2">‚úÖ <strong>Medical:</strong> Doctors often require chronological age in months for infants.</li>
            </ul>
          </div>

          <div>
            <h4 class="font-bold text-gray-800 mb-2 flex items-center gap-2">üáÆüá≥ Govt Job Uses (India)</h4>
            <ul class="space-y-2 text-sm text-gray-600">
                <li class="flex items-center gap-2">‚úÖ <strong>UPSC Civil Services:</strong> Check 21-32 years criteria.</li>
                <li class="flex items-center gap-2">‚úÖ <strong>SSC CGL / CHSL:</strong> Verify age on 1st Aug or 1st Jan.</li>
                <li class="flex items-center gap-2">‚úÖ <strong>Banking (IBPS/SBI):</strong> Confirm eligibility before applying.</li>
            </ul>
          </div>
      </div>
  </div>

</ToolLayout>

{/* üß† JAVASCRIPT LOGIC (Unchanged - It works perfectly) */}
<script>
  const dobInput = document.getElementById('dobInput');
  const todayInput = document.getElementById('todayInput');
  const calcBtn = document.getElementById('calcBtn');
  const resultArea = document.getElementById('resultArea');
  
  const today = new Date();
  todayInput.valueAsDate = today;

  calcBtn?.addEventListener('click', () => {
      const dobVal = dobInput.value;
      const targetVal = todayInput.value;

      if (!dobVal) {
          alert("Please select your Date of Birth üìÖ");
          return;
      }

      const dob = new Date(dobVal);
      const target = new Date(targetVal);

      if (dob > target) {
          alert("Date of Birth cannot be in the future! üòÖ");
          return;
      }

      let years = target.getFullYear() - dob.getFullYear();
      let months = target.getMonth() - dob.getMonth();
      let days = target.getDate() - dob.getDate();

      if (days < 0) {
          months--;
          const prevMonthDate = new Date(target.getFullYear(), target.getMonth(), 0);
          days += prevMonthDate.getDate();
      }

      if (months < 0) {
          years--;
          months += 12;
      }

      document.getElementById('resYears').innerText = years.toString();
      document.getElementById('resMonths').innerText = months.toString();
      document.getElementById('resDays').innerText = days.toString();

      const diffTime = Math.abs(target.getTime() - dob.getTime());
      const totalDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));
      const totalHours = totalDays * 24;
      
      document.getElementById('totalMonths').innerText = ((years * 12) + months).toString();
      document.getElementById('totalDays').innerText = totalDays.toLocaleString();
      document.getElementById('totalHours').innerText = totalHours.toLocaleString();

      const currentYear = target.getFullYear();
      let nextBday = new Date(dob);
      nextBday.setFullYear(currentYear);
      
      if (nextBday < target) {
          nextBday.setFullYear(currentYear + 1);
      }
      
      const daysToBday = Math.ceil((nextBday.getTime() - target.getTime()) / (1000 * 60 * 60 * 24));
      const daysOfWeek = ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"];
      
      document.getElementById('nextBdayDay').innerText = daysOfWeek[nextBday.getDay()];
      document.getElementById('nextBdayMonth').innerText = daysToBday === 0 ? "Today! üéÇ" : `in ${daysToBday} days`;

      resultArea.classList.remove('hidden');
      resultArea.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
  });
</script>
