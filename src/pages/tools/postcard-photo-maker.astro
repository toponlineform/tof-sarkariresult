---
// src/pages/tools/postcard-photo-maker.astro
import ToolLayout from '../../layouts/ToolLayout.astro';
import AdSlot from '../../components/AdSlot.astro';

// üáÆüá≥ INDIA SPECIFIC SEO
const title = "Postcard Photo Maker (4x6 inch) for SSC, NEET & JEE - Free Online";
const description = "Create 4x6 inch Postcard Size Photograph required for SSC CGL, NEET, JEE and other NTA exams. Convert any photo to 4x6 ratio instantly.";
---

<ToolLayout 
  title={title} 
  description={description}
  toolName="Postcard Photo Maker"
>

  {/* ‚ö° FAQ SCHEMA */}
  <script type="application/ld+json" slot="head">
    {
      "@context": "https://schema.org",
      "@type": "FAQPage",
      "mainEntity": [{
        "@type": "Question",
        "name": "What is the size of Postcard Photograph for SSC?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "The standard postcard size for SSC and NTA exams is 4 inches x 6 inches (10.16 cm x 15.24 cm). Our tool generates this exact size."
        }
      }, {
        "@type": "Question",
        "name": "How to create 4x6 photo from mobile?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Upload your normal portrait photo in this tool. It will automatically lock the 4:6 aspect ratio. Adjust the crop to fit your face and download the high-quality JPG."
        }
      }]
    }
  </script>

  {/* Load CropperJS */}
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.13/cropper.min.css" />
  <script is:inline src="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.13/cropper.min.js"></script>

  {/* 1. TOP AD SLOT */}
  <div class="mb-8">
    <AdSlot type="horizontal" />
  </div>

  <div class="space-y-8">
      
      {/* STEP 1: UPLOAD */}
      <div id="step1" class="py-16 text-center bg-blue-50 border-4 border-dashed border-blue-200 rounded-3xl cursor-pointer hover:border-blue-400 hover:shadow-xl transition relative group" onclick="document.getElementById('fileInput').click()">
          <div class="relative z-10">
            <div class="text-7xl mb-6 group-hover:scale-110 transition duration-200 drop-shadow-sm">üñºÔ∏è</div>
            <h3 class="text-3xl font-extrabold text-gray-800 mb-2">Create Postcard Photo (4x6)</h3>
            <p class="text-gray-500 mb-8 font-medium text-lg">For SSC, NEET, JEE & Railway</p>
            
            <span class="bg-blue-600 text-white px-8 py-4 rounded-xl font-bold text-lg shadow-lg hover:bg-blue-700 transition flex items-center justify-center gap-2 w-max mx-auto transform group-hover:-translate-y-1">
                <span>üìÇ</span> Select Your Photo
            </span>
          </div>
          <input type="file" id="fileInput" accept="image/*" class="hidden" />
      </div>

      {/* STEP 2: CROP & PREVIEW */}
      <div id="step2" class="hidden animate-fade-in">
          <div class="flex flex-col lg:flex-row gap-8">
              
              {/* Left: Cropper */}
              <div class="w-full lg:w-2/3 bg-gray-900 rounded-xl overflow-hidden shadow-2xl relative h-[500px] border border-gray-700">
                  <img id="cropImage" class="max-w-full" />
                  <div class="absolute bottom-4 left-0 right-0 text-center pointer-events-none z-10">
                      <span class="bg-black/70 text-white px-4 py-2 rounded-full text-sm backdrop-blur-md">
                         Adjust frame to show Head & Shoulders
                      </span>
                  </div>
              </div>

              {/* Right: Controls */}
              <div class="w-full lg:w-1/3 space-y-6">
                  
                  <div class="bg-yellow-50 p-5 rounded-xl border border-yellow-200 shadow-sm">
                      <h4 class="font-bold text-yellow-900 mb-2 flex items-center gap-2">
                          <span>üì¢</span> Exam Rules:
                      </h4>
                      <ul class="text-sm text-yellow-800 space-y-1 list-disc pl-4">
                          <li>Aspect Ratio is Locked to <strong>4:6</strong>.</li>
                          <li>Both <strong>ears must be visible</strong>.</li>
                          <li>Look straight at the camera.</li>
                      </ul>
                  </div>

                  <button id="cropBtn" class="w-full bg-gradient-to-r from-blue-600 to-cyan-600 hover:from-blue-700 hover:to-cyan-700 text-white font-bold py-5 px-6 rounded-xl shadow-xl transition transform hover:-translate-y-1 flex justify-center items-center gap-3 text-xl">
                      <span>‚ú®</span> Generate Photo
                  </button>
                  
                  <button onclick="location.reload()" class="w-full text-gray-500 underline text-sm hover:text-gray-700">
                      Upload Different Photo
                  </button>
              </div>
          </div>
      </div>

      {/* STEP 3: DOWNLOAD */}
      <div id="step3" class="hidden animate-fade-in text-center">
          <h3 class="text-2xl font-bold text-gray-800 mb-2">üéâ Postcard Photo Ready!</h3>
          <p class="text-gray-500 mb-6">Size: 4 inch x 6 inch (1200x1800 px)</p>
          
          <div class="inline-block border-[10px] border-white shadow-2xl bg-gray-200 rounded-sm overflow-hidden mb-8">
               <canvas id="photoCanvas" class="max-w-full h-auto max-h-[500px]"></canvas>
          </div>

          <div class="flex flex-col sm:flex-row gap-4 justify-center max-w-lg mx-auto">
              <button id="downloadBtn" class="flex-1 bg-green-600 hover:bg-green-700 text-white font-bold py-4 px-8 rounded-xl shadow-xl text-lg flex justify-center items-center gap-2 transition transform hover:-translate-y-1">
                  ‚¨áÔ∏è Download HD JPG
              </button>
              <button onclick="location.reload()" class="flex-1 bg-white border border-gray-300 hover:bg-gray-50 text-gray-700 font-bold py-4 px-8 rounded-xl shadow-sm transition">
                  ‚Ü∫ Create New
              </button>
          </div>
          
          <div class="mt-8 text-xs text-gray-400">
              Print this on 4x6 Glossy Paper
          </div>
      </div>

  </div>

  {/* 2. MIDDLE AD SLOT */}
  <div class="mb-8 mt-12">
     <AdSlot type="horizontal" />
  </div>

  {/* SEO CONTENT */}
  <div slot="content">
      <h3 class="text-xl font-bold text-gray-800 mb-3">Why 4x6 Postcard Photo?</h3>
      <p class="text-gray-600 mb-4">
          Government exams like <strong>SSC CGL, CHSL, MTS</strong> and NTA exams like <strong>NEET and JEE Main</strong> require candidates to bring a "Postcard Size Photograph" to the exam center. This photo is pasted on the attendance sheet.
      </p>
      
      <div class="bg-white p-6 rounded-xl border border-gray-200 shadow-sm">
          <h4 class="font-bold text-gray-800 mb-3">Dimensions Explained:</h4>
          <div class="grid grid-cols-2 md:grid-cols-4 gap-4 text-center">
              <div class="bg-gray-50 p-3 rounded-lg">
                  <span class="block text-xs text-gray-500 uppercase">Inches</span>
                  <strong class="text-blue-600 text-lg">4" x 6"</strong>
              </div>
              <div class="bg-gray-50 p-3 rounded-lg">
                  <span class="block text-xs text-gray-500 uppercase">Centimeters</span>
                  <strong class="text-blue-600 text-lg">10.16 x 15.24</strong>
              </div>
              <div class="bg-gray-50 p-3 rounded-lg">
                  <span class="block text-xs text-gray-500 uppercase">Millimeters</span>
                  <strong class="text-blue-600 text-lg">101.6 x 152.4</strong>
              </div>
              <div class="bg-gray-50 p-3 rounded-lg">
                  <span class="block text-xs text-gray-500 uppercase">Pixels (300 DPI)</span>
                  <strong class="text-blue-600 text-lg">1200 x 1800</strong>
              </div>
          </div>
      </div>
  </div>

</ToolLayout>

{/* üß† LOGIC */}
<script>
  // @ts-nocheck
  const fileInput = document.getElementById('fileInput');
  const step1 = document.getElementById('step1');
  const step2 = document.getElementById('step2');
  const step3 = document.getElementById('step3');
  const cropImage = document.getElementById('cropImage');
  const cropBtn = document.getElementById('cropBtn');
  const photoCanvas = document.getElementById('photoCanvas');
  const downloadBtn = document.getElementById('downloadBtn');

  let cropper = null;

  // 1. Upload
  fileInput?.addEventListener('change', (e) => {
      if (e.target.files && e.target.files.length > 0) {
          const file = e.target.files[0];
          cropImage.src = URL.createObjectURL(file);
          
          step1.classList.add('hidden');
          step2.classList.remove('hidden');

          if(cropper) cropper.destroy();
          cropper = new Cropper(cropImage, {
              aspectRatio: 4 / 6, // 4:6 Postcard Ratio
              viewMode: 1,
              dragMode: 'move',
              autoCropArea: 0.9,
              guides: true,
              center: true,
              background: false,
              highlight: false,
              toggleDragModeOnDblclick: false,
          });
      }
  });

  // 2. Generate
  cropBtn?.addEventListener('click', () => {
      if(!cropper) return;

      // 4x6 inches @ 300 DPI = 1200x1800 px
      const targetW = 1200;
      const targetH = 1800;

      const croppedCanvas = cropper.getCroppedCanvas({
          width: targetW, height: targetH,
          imageSmoothingQuality: 'high'
      });

      photoCanvas.width = targetW;
      photoCanvas.height = targetH;
      const ctx = photoCanvas.getContext('2d');
      
      // Draw onto final canvas
      ctx.drawImage(croppedCanvas, 0, 0, targetW, targetH);

      step2.classList.add('hidden');
      step3.classList.remove('hidden');
      window.scrollTo(0, 0);
  });

  // 3. Download
  downloadBtn?.addEventListener('click', () => {
      const link = document.createElement('a');
      link.download = `Postcard-4x6-${Date.now()}.jpg`;
      link.href = photoCanvas.toDataURL('image/jpeg', 0.95);
      link.click();
  });
</script>
