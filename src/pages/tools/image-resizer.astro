---
import ToolLayout from '../../layouts/ToolLayout.astro';
import AdSlot from '../../components/AdSlot.astro';

// üî• META TAGS FOR HIGH CTR
const title = "Image Resizer Online - Resize Photo to 3.5cm x 4.5cm, 20KB (SSC/UPSC)";
const description = "Free Online Image Resizer for Govt Jobs. Convert Photo to 3.5cm x 4.5cm (350x450 px). Resize and Compress image to 20kb, 50kb for SSC, IBPS, and Railway forms.";
---

<ToolLayout 
  title={title} 
  description={description}
  toolName="Image Resizer"
>

  {/* ‚ö° FAQ SCHEMA (Rich Results) */}
  <script type="application/ld+json" slot="head">
    {
      "@context": "https://schema.org",
      "@type": "FAQPage",
      "mainEntity": [{
        "@type": "Question",
        "name": "How to resize photo to 3.5cm x 4.5cm?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "To get 3.5cm x 4.5cm size, set the Width to 350 px and Height to 450 px in our Infinity Image Resizer. This resolution is perfect for SSC and UPSC forms at 100 DPI."
        }
      }, {
        "@type": "Question",
        "name": "How to reduce image size to 20kb?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Upload your photo, set the 'Max Size' slider to 20KB, and click Resize. The tool automatically compresses the quality while keeping dimensions intact."
        }
      }]
    }
  </script>

  {/* External Library */}
  <script is:inline src="https://cdnjs.cloudflare.com/ajax/libs/browser-image-compression/2.0.2/browser-image-compression.min.js"></script>

  {/* üü¢ TOP AD */}
  <div class="mb-6">
    <AdSlot type="horizontal" />
  </div>

  {/* MAIN TOOL AREA */}
  <div class="space-y-8">
      
      {/* STEP 1: UPLOAD */}
      <div id="step1" class="py-12 text-center bg-gradient-to-b from-blue-50 to-white border-4 border-dashed border-blue-200 rounded-3xl cursor-pointer hover:border-blue-400 hover:shadow-md transition relative group" onclick="document.getElementById('imageInput').click()">
          <div class="relative z-10">
            <div class="text-7xl mb-4 group-hover:scale-110 transition duration-200 drop-shadow-sm">üìè</div>
            <h3 class="text-3xl font-extrabold text-gray-800 mb-2">Resize Image Dimensions</h3>
            <p class="text-gray-500 mb-8 font-medium text-lg">Change Width/Height & File Size (KB)</p>
            
            <span class="bg-blue-600 text-white px-8 py-4 rounded-xl font-bold text-lg shadow-lg group-hover:bg-blue-700 transition flex items-center justify-center gap-2 w-max mx-auto">
                <span>üìÇ</span> Upload Image
            </span>
            <p class="mt-4 text-xs text-gray-400">Supports JPG, PNG, WEBP</p>
          </div>
          <input type="file" id="imageInput" accept="image/*" class="hidden" />
      </div>

      {/* STEP 2: EDITOR (Hidden initially) */}
      <div id="step2" class="hidden animate-fade-in">
          <div class="flex flex-col lg:flex-row gap-8">
              
              {/* Left: Preview */}
              <div class="w-full lg:w-1/3 bg-white p-4 rounded-xl border border-gray-200 shadow-sm flex flex-col items-center justify-center">
                  <div class="relative w-full h-[300px] bg-gray-100 rounded-lg overflow-hidden flex items-center justify-center border border-gray-100">
                      <img id="previewImg" class="max-h-full max-w-full object-contain" />
                  </div>
                  <div class="mt-4 w-full grid grid-cols-2 gap-2 text-xs font-mono text-gray-600">
                      <div class="bg-gray-50 p-2 rounded text-center">
                          <span class="block text-gray-400 uppercase text-[10px]">Original Size</span>
                          <strong id="origSize" class="text-blue-600 text-sm">0 KB</strong>
                      </div>
                      <div class="bg-gray-50 p-2 rounded text-center">
                          <span class="block text-gray-400 uppercase text-[10px]">Dimensions</span>
                          <strong id="origDims" class="text-gray-800 text-sm">0 x 0</strong>
                      </div>
                  </div>
              </div>

              {/* Right: Controls */}
              <div class="w-full lg:w-2/3 bg-white p-6 rounded-xl border border-gray-200 shadow-md space-y-6">
                  
                  <div class="border-b pb-4 mb-2">
                      <h4 class="text-lg font-bold text-gray-800 flex items-center gap-2">
                          <span>üìê</span> Set New Dimensions <span class="text-xs font-normal text-gray-500 bg-gray-100 px-2 py-1 rounded">Pixels (px)</span>
                      </h4>
                  </div>

                  {/* Dimensions Inputs */}
                  <div class="grid grid-cols-2 gap-6">
                      <div>
                          <label class="block text-sm font-bold text-gray-600 mb-2">Width</label>
                          <input type="number" id="widthInput" class="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-blue-500 focus:ring-0 outline-none transition font-mono font-bold text-gray-700" placeholder="e.g. 350">
                      </div>
                      <div>
                          <label class="block text-sm font-bold text-gray-600 mb-2">Height</label>
                          <input type="number" id="heightInput" class="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-blue-500 focus:ring-0 outline-none transition font-mono font-bold text-gray-700" placeholder="e.g. 450">
                      </div>
                  </div>

                  {/* Size Slider */}
                  <div class="bg-blue-50 p-4 rounded-xl border border-blue-100">
                      <label class="block text-sm font-bold text-gray-800 mb-4 flex justify-between items-center">
                          <span>Compress to Max Size</span>
                          <span id="targetKBText" class="text-white bg-blue-600 px-3 py-1 rounded-lg text-sm shadow-sm">50 KB</span>
                      </label>
                      <input type="range" id="sizeSlider" min="10" max="500" value="50" class="w-full h-2 bg-gray-300 rounded-lg appearance-none cursor-pointer accent-blue-600">
                      <div class="flex justify-between text-xs text-gray-400 mt-2 font-medium">
                          <span>10 KB (Extreme)</span>
                          <span>500 KB (High Quality)</span>
                      </div>
                  </div>

                  {/* Action Buttons */}
                  <div class="flex flex-col sm:flex-row gap-3 pt-2">
                      <button id="processBtn" class="flex-1 bg-gradient-to-r from-blue-600 to-indigo-600 text-white font-bold py-4 rounded-xl shadow-lg flex justify-center items-center gap-2 hover:shadow-xl hover:-translate-y-0.5 transition">
                          <span id="btnText">Resize & Download Image üöÄ</span>
                          <span id="loader" class="hidden animate-spin h-5 w-5 border-2 border-white border-t-transparent rounded-full"></span>
                      </button>
                      <button id="resetBtn" class="sm:w-auto w-full bg-gray-50 border border-gray-200 text-gray-600 font-bold py-4 px-6 rounded-xl hover:bg-gray-100 transition">
                          Reset
                      </button>
                  </div>

              </div>
          </div>
      </div>

  </div>

  {/* SEO CONTENT (Added the Magic Table here) */}
  <div slot="content">
      <p class="lead text-lg text-gray-700 mb-6">
          Govt job portals often ask for photo dimensions in centimeters (cm) or millimeters (mm), but online tools require pixels (px). Use the <strong>Infinity Image Resizer</strong> to set exact Width and Height in pixels.
      </p>

      {/* üåü THE MAGIC TABLE FOR SEO SNIPPETS */}
      <h3 class="text-xl font-bold text-gray-800 mb-4">Common Photo Dimensions for Govt Exams (CM to Pixels)</h3>
      <div class="overflow-hidden rounded-xl border border-gray-200 mb-8 shadow-sm">
        <table class="min-w-full text-sm text-left bg-white">
            <thead class="bg-gray-50 text-gray-700 font-bold border-b">
                <tr>
                    <th class="p-4">Document Type</th>
                    <th class="p-4">Size in CM</th>
                    <th class="p-4">Size in Pixels (Approx)</th>
                </tr>
            </thead>
            <tbody class="divide-y divide-gray-100">
                <tr class="hover:bg-blue-50 transition">
                    <td class="p-4 font-medium">Passport Photo</td>
                    <td class="p-4">3.5 cm x 4.5 cm</td>
                    <td class="p-4 text-blue-700 font-bold font-mono">350 x 450 px</td>
                </tr>
                <tr class="hover:bg-blue-50 transition">
                    <td class="p-4 font-medium">Signature</td>
                    <td class="p-4">4.0 cm x 2.0 cm</td>
                    <td class="p-4 text-blue-700 font-bold font-mono">400 x 200 px</td>
                </tr>
                <tr class="hover:bg-blue-50 transition">
                    <td class="p-4 font-medium">Thumb Impression</td>
                    <td class="p-4">3.0 cm x 3.0 cm</td>
                    <td class="p-4 text-blue-700 font-bold font-mono">300 x 300 px</td>
                </tr>
                <tr class="hover:bg-blue-50 transition">
                    <td class="p-4 font-medium">Postcard Size</td>
                    <td class="p-4">4.0 cm x 6.0 cm</td>
                    <td class="p-4 text-blue-700 font-bold font-mono">400 x 600 px</td>
                </tr>
            </tbody>
        </table>
      </div>

      <h3>How to use for SSC/UPSC?</h3>
      <ul class="list-disc pl-5 space-y-2 text-gray-700">
          <li><strong>Step 1:</strong> Upload your image.</li>
          <li><strong>Step 2:</strong> Look at the table above. If you need 3.5cm width, enter <strong>350</strong> in the Width box.</li>
          <li><strong>Step 3:</strong> Enter <strong>450</strong> in the Height box.</li>
          <li><strong>Step 4:</strong> Adjust the slider to <strong>20KB or 50KB</strong> as per the notification.</li>
          <li><strong>Step 5:</strong> Click Download.</li>
      </ul>
  </div>

</ToolLayout>

{/* üß† LOGIC (Robust) */}
<script>
  // @ts-nocheck
  const imageInput = document.getElementById('imageInput');
  const step1 = document.getElementById('step1');
  const step2 = document.getElementById('step2');
  const previewImg = document.getElementById('previewImg');
  const origSize = document.getElementById('origSize');
  const origDims = document.getElementById('origDims');
  const widthInput = document.getElementById('widthInput');
  const heightInput = document.getElementById('heightInput');
  const sizeSlider = document.getElementById('sizeSlider');
  const targetKBText = document.getElementById('targetKBText');
  const processBtn = document.getElementById('processBtn');
  const btnText = document.getElementById('btnText');
  const loader = document.getElementById('loader');
  const resetBtn = document.getElementById('resetBtn');

  let originalFile = null;

  // 1. File Upload
  imageInput?.addEventListener('change', (e) => {
      if (e.target.files && e.target.files.length > 0) {
          originalFile = e.target.files[0];
          
          const url = URL.createObjectURL(originalFile);
          previewImg.src = url;
          
          const img = new Image();
          img.src = url;
          img.onload = () => {
              origDims.innerText = `${img.width} x ${img.height}`;
              // Smart Defaults: If image is huge, suggest smaller dims
              widthInput.value = img.width; 
              heightInput.value = img.height;
          };

          origSize.innerText = (originalFile.size / 1024).toFixed(2) + " KB";

          step1.classList.add('hidden');
          step2.classList.remove('hidden');
      }
  });

  // 2. Slider Update
  sizeSlider?.addEventListener('input', (e) => {
      targetKBText.innerText = e.target.value + " KB";
  });

  // 3. Process
  processBtn?.addEventListener('click', async () => {
      if (!originalFile) return;

      btnText.innerText = "Processing...";
      loader.classList.remove('hidden');
      processBtn.disabled = true;
      processBtn.classList.add('opacity-75');

      const targetKB = parseInt(sizeSlider.value);
      const targetWidth = parseInt(widthInput.value) || undefined;
      const targetHeight = parseInt(heightInput.value) || undefined;

      // Note: The library preserves aspect ratio by default. 
      // To force exact dimensions, we might need a canvas approach in future updates,
      // but for now, maxWidthOrHeight is the safest bet for quality.
      const options = {
          maxSizeMB: targetKB / 1024,
          maxWidthOrHeight: Math.max(targetWidth || 1920, targetHeight || 1920),
          useWebWorker: true
      };

      try {
          const compressedFile = await imageCompression(originalFile, options);
          
          const link = document.createElement("a");
          link.href = URL.createObjectURL(compressedFile);
          link.download = `Resized-${originalFile.name}`;
          link.click();

          btnText.innerText = "Success! Resize Another";
      } catch (error) {
          console.error(error);
          alert("Could not process image. Try a different file.");
          btnText.innerText = "Try Again";
      } finally {
          loader.classList.add('hidden');
          processBtn.disabled = false;
          processBtn.classList.remove('opacity-75');
      }
  });

  // 4. Reset
  resetBtn?.addEventListener('click', () => {
      location.reload();
  });
</script>
